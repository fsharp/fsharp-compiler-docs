<!DOCTYPE html>
<html lang="en" data-root="https://fsharp.github.io/fsharp-compiler-docs/">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="F# Software Foundation; Microsoft; F# Contributors" name="author">
    <!-- Opengraph properties (https://ogp.me/) -->
    <meta property="og:site_name" content="F# Compiler Guide">
    <meta property="og:title" content="Tutorial: Hosted execution" />
    <meta property="og:url" content="https://fsharp.github.io/fsharp-compiler-docs/fcs/interactive.html">
    <meta property="og:type" content="website" />
    <!-- Twitter cards (https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/summary-card-with-large-image) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="https://fsharp.github.io/fsharp-compiler-docs/">
    <meta name="twitter:title" content="Tutorial: Hosted execution">
    
    <title>Tutorial: Hosted execution | F# Compiler Guide</title>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="https://fsharp.github.io/fsharp-compiler-docs/img/favicon.ico" rel="icon" sizes="32x32" type="image/png"/>
    <script type="application/javascript" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-theme-set-dark.js"></script>
    <script type="application/javascript" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-details-set-expanded.js"></script>
    <link href="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-default.css" rel="stylesheet" type="text/css"/>
    <link href="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-theme.css" rel="stylesheet" type="text/css"/>
    
    
</head>
<body class="content">
<header>
    <div class="start">
        <div id="menu-toggle">
            <iconify-icon class="icon closed" height="22" icon="eva:menu-fill" width="22"></iconify-icon>
            <iconify-icon class="icon open" height="22" icon="mi:close" width="22"></iconify-icon>
            <input type="checkbox" name="mobile-menu" />
            <ul class="menu">
                <li class="nav-header">Links</li>
                <li class="license-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/dotnet/fsharp/blob/main/License.txt">License</a>
                </li>
                <li class="release-notes-menu-item builtin-menu-item nav-item"><a class="nav-link"
                                        href="https://github.com/dotnet/fsharp/blob/main/release-notes.md">Release
                    Notes</a></li>
                <li class="repository-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/dotnet/fsharp/">Source
                    Repository</a></li>
                <li class="nav-header ">
  Compiler Internals
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/reusing-typechecking-results.html">
    Reusing typechecking results
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/overview.html">
    Overview
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/coding-standards.html">
    Coding standards
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/diagnostics.html">
    Diagnostics
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/representations.html">
    Representations
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/debug-emit.html">
    Debug emit
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/names.html">
    Display names, logical names and compiled names
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fsi-emit.html">
    F# Interactive Emit
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/optimizations.html">
    Optimizations
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/large-inputs-and-stack-overflows.html">
    Large inputs
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/memory-usage.html">
    Memory usage
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/compiler-startup-performance.html">
    Startup Performance
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/changing-the-ast.html">
    Changing the AST
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/running-documentation-locally.html">
    Running the documentation locally
  </a>
</li>             
<li class="nav-header ">
  Language Service Internals
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/tooling-features.html">
    Overview
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/project-builds.html">
    Project builds
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/caches.html">
    FSharpChecker caches
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/react.html">
    Incrementality
  </a>
</li>             
<li class="nav-header active">
  FSharp.Compiler.Service
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/tokenizer.html">
    Tutorial: Tokenizing
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/untypedtree.html">
    Tutorial: Expressions
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/untypedtree-apis.html">
    Tutorial: AST APIs
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/symbols.html">
    Tutorial: Symbols
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/editor.html">
    Tutorial: Editor services
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/typedtree.html">
    Tutorial: Expressions
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/project.html">
    Tutorial: Project analysis
  </a>
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/interactive.html">
    Tutorial: Hosted execution
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/compiler.html">
    Tutorial: Hosting the compiler
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/corelib.html">
    Notes on FSharp.Core
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/filesystem.html">
    IFileSystem
  </a>
</li>             
<li class="nav-header ">
  FSharp.Core
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fsharp-core-notes.html">
    Guidance
  </a>
</li>             
<li class="nav-header ">
  Release Notes
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/About.html">
    About
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/Language.html">
    F# Language
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/FSharp.Core.html">
    FSharp.Core
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/FSharp.Compiler.Service.html">
    FSharp.Compiler.Service
  </a>
</li>             
<li class="nav-header ">
  Other
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/perf-discussions-archive.html">
    Comparisons

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/optimizations-equality.html">
    Compiling Equality

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/lsp.html">
    F# LSP

  </a>
</li>
                <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/reference/index.html">
    All Namespaces
  </a>
</li>
            </ul>
        </div>
        <a href="https://fsharp.github.io/fsharp-compiler-docs/">
            <img alt="Header menu logo" src="https://fsharp.github.io/fsharp-compiler-docs/img/logo.png">
            <strong>F# Compiler Guide</strong>
        </a>
    </div>
    <div class="end">
        <a href="https://github.com/dotnet/fsharp/" target="_blank">
            <iconify-icon icon="uil:github" width="26" height="26"></iconify-icon>
        </a>
        <iconify-icon id="search-btn" icon="carbon:search" class="search" width="24" height="24"></iconify-icon>
        <fsdocs-theme-toggle></fsdocs-theme-toggle>
    </div>
</header>
<aside id="fsdocs-main-menu">
    <ul class="menu">
        <li class="nav-header">Links</li>
        <li class="license-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/dotnet/fsharp/blob/main/License.txt">License</a>
        </li>
        <li class="release-notes-menu-item builtin-menu-item nav-item"><a class="nav-link"
                                href="https://github.com/dotnet/fsharp/blob/main/release-notes.md">Release
            Notes</a></li>
        <li class="repository-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/dotnet/fsharp/">Source
            Repository</a></li>
        <li class="nav-header ">
  Compiler Internals
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/reusing-typechecking-results.html">
    Reusing typechecking results
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/overview.html">
    Overview
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/coding-standards.html">
    Coding standards
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/diagnostics.html">
    Diagnostics
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/representations.html">
    Representations
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/debug-emit.html">
    Debug emit
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/names.html">
    Display names, logical names and compiled names
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fsi-emit.html">
    F# Interactive Emit
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/optimizations.html">
    Optimizations
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/large-inputs-and-stack-overflows.html">
    Large inputs
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/memory-usage.html">
    Memory usage
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/compiler-startup-performance.html">
    Startup Performance
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/changing-the-ast.html">
    Changing the AST
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/running-documentation-locally.html">
    Running the documentation locally
  </a>
</li>             
<li class="nav-header ">
  Language Service Internals
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/tooling-features.html">
    Overview
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/project-builds.html">
    Project builds
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/caches.html">
    FSharpChecker caches
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/react.html">
    Incrementality
  </a>
</li>             
<li class="nav-header active">
  FSharp.Compiler.Service
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/tokenizer.html">
    Tutorial: Tokenizing
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/untypedtree.html">
    Tutorial: Expressions
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/untypedtree-apis.html">
    Tutorial: AST APIs
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/symbols.html">
    Tutorial: Symbols
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/editor.html">
    Tutorial: Editor services
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/typedtree.html">
    Tutorial: Expressions
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/project.html">
    Tutorial: Project analysis
  </a>
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/interactive.html">
    Tutorial: Hosted execution
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/compiler.html">
    Tutorial: Hosting the compiler
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/corelib.html">
    Notes on FSharp.Core
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fcs/filesystem.html">
    IFileSystem
  </a>
</li>             
<li class="nav-header ">
  FSharp.Core
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/fsharp-core-notes.html">
    Guidance
  </a>
</li>             
<li class="nav-header ">
  Release Notes
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/About.html">
    About
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/Language.html">
    F# Language
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/FSharp.Core.html">
    FSharp.Core
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/release-notes/FSharp.Compiler.Service.html">
    FSharp.Compiler.Service
  </a>
</li>             
<li class="nav-header ">
  Other
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/perf-discussions-archive.html">
    Comparisons

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/optimizations-equality.html">
    Compiling Equality

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/lsp.html">
    F# LSP

  </a>
</li>
        <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fsharp.github.io/fsharp-compiler-docs/reference/index.html">
    All Namespaces
  </a>
</li>
    </ul>
</aside>
<main>
    <div id="content">
        
<h1><a name="Interactive-Service-Embedding-F-Interactive" class="anchor" href="#Interactive-Service-Embedding-F-Interactive">Interactive Service: Embedding F# Interactive</a></h1>
<p>This tutorial demonstrates how to embed F# interactive in your application. F# interactive
is an interactive scripting environment that compiles F# code into highly efficient IL code
and executes it on the fly. The F# interactive service allows you to embed F# evaluation in
your application.</p>
<blockquote>
<p><strong>NOTE:</strong> There is a number of options for embedding F# Interactive. The easiest one is to use the
<code>fsi.exe</code> process and communicate with it using standard input and standard output. In this
tutorial, we look at calling F# Interactive directly through .NET API. However, if you have
no control over the input, it is a good idea to run F# interactive in a separate process.
One reason is that there is no way to handle <code>StackOverflowException</code> and so a poorly written
script can terminate the host process. <strong>Remember that while calling F# Interactive through .NET API,
<code>--shadowcopyreferences</code> option will be ignored</strong>. For detailed discussion, please take a look at
<a href="https://github.com/fsharp/FSharp.Compiler.Service/issues/292">this thread</a>.
<strong>NOTE:</strong> If <code>FsiEvaluationSession.Create</code> fails with an error saying that <code>FSharp.Core.dll</code> cannot be found,
add the <code>FSharp.Core.sigdata</code> and <code>FSharp.Core.optdata</code> files. More info <a href="https://fsharp.github.io/fsharp-compiler-docs/fcs/corelib.html">here</a>.</p>
</blockquote>
<p>However, the F# interactive service is still useful, because you might want to wrap it in your
own executable that is then executed (and communicates with the rest of your application), or
if you only need to execute a limited subset of F# code (e.g. generated by your own DSL).</p>
<h2><a name="Starting-the-F-interactive" class="anchor" href="#Starting-the-F-interactive">Starting the F# interactive</a></h2>
<p>First, we need to reference the libraries that contain the F# interactive service:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="pp">#r</span> <span class="s">&quot;FSharp.Compiler.Service.dll&quot;</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">Compiler</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">Interactive</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="m">Shell</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 5)" onmouseover="showTip(event, 'fs1', 5)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 6)" onmouseover="showTip(event, 'fs2', 6)" class="id">Compiler</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="id">Tokenization</span>
</code></pre>
<p>To communicate with F# interactive, we need to create streams that represent input and
output. We will use those later to read the output printed as a result of evaluating some
F# code that prints:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="id">System</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="id">System</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="id">IO</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 11)" onmouseover="showTip(event, 'fs6', 11)" class="id">System</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs8', 12)" onmouseover="showTip(event, 'fs8', 12)" class="id">Text</span>

<span class="c">// Initialize output and input streams</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="id">sbOut</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="rt">StringBuilder</span><span class="pn">(</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="id">sbErr</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="rt">StringBuilder</span><span class="pn">(</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="d">inStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="d">StringReader</span><span class="pn">(</span><span class="s">&quot;&quot;</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="d">outStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="d">StringWriter</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs9', 21)" onmouseover="showTip(event, 'fs9', 21)" class="id">sbOut</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 22)" onmouseover="showTip(event, 'fs16', 22)" class="d">errStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="d">StringWriter</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs11', 24)" onmouseover="showTip(event, 'fs11', 24)" class="id">sbErr</span><span class="pn">)</span>

<span class="c">// Build command line arguments &amp; start FSI session</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 25)" onmouseover="showTip(event, 'fs17', 25)" class="id">argv</span> <span class="o">=</span> <span class="pn">[|</span> <span class="s">&quot;C:\\fsi.exe&quot;</span> <span class="pn">|]</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 26)" onmouseover="showTip(event, 'fs18', 26)" class="id">allArgs</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs19', 27)" onmouseover="showTip(event, 'fs19', 27)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 28)" onmouseover="showTip(event, 'fs20', 28)" class="id">append</span> <span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="id">argv</span> <span class="pn">[|</span> <span class="s">&quot;--noninteractive&quot;</span> <span class="pn">|]</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 30)" onmouseover="showTip(event, 'fs21', 30)" class="id">fsiConfig</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs22', 31)" onmouseover="showTip(event, 'fs22', 31)" class="d">FsiEvaluationSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs23', 32)" onmouseover="showTip(event, 'fs23', 32)" class="id">GetDefaultConfiguration</span><span class="pn">(</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 33)" onmouseover="showTip(event, 'fs24', 33)" class="d">fsiSession</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs22', 34)" onmouseover="showTip(event, 'fs22', 34)" class="d">FsiEvaluationSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 35)" onmouseover="showTip(event, 'fs25', 35)" class="id">Create</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 36)" onmouseover="showTip(event, 'fs21', 36)" class="id">fsiConfig</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs18', 37)" onmouseover="showTip(event, 'fs18', 37)" class="id">allArgs</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs12', 38)" onmouseover="showTip(event, 'fs12', 38)" class="d">inStream</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs14', 39)" onmouseover="showTip(event, 'fs14', 39)" class="d">outStream</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs16', 40)" onmouseover="showTip(event, 'fs16', 40)" class="d">errStream</span><span class="pn">)</span>
</code></pre>
<h2><a name="Evaluating-and-executing-code" class="anchor" href="#Evaluating-and-executing-code">Evaluating and executing code</a></h2>
<p>The F# interactive service exposes several methods that can be used for evaluation. The first
is <code>EvalExpression</code> which evaluates an expression and returns its result. The result contains
the returned value (as <code>obj</code>) and the statically inferred type of the value:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Evaluate expression &amp; return the result</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 41)" onmouseover="showTip(event, 'fs26', 41)" class="fn">evalExpression</span> <span onmouseout="hideTip(event, 'fs27', 42)" onmouseover="showTip(event, 'fs27', 42)" class="fn">text</span> <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs24', 43)" onmouseover="showTip(event, 'fs24', 43)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 44)" onmouseover="showTip(event, 'fs28', 44)" class="id">EvalExpression</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 45)" onmouseover="showTip(event, 'fs27', 45)" class="fn">text</span><span class="pn">)</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs29', 46)" onmouseover="showTip(event, 'fs29', 46)" class="uc">Some</span> <span onmouseout="hideTip(event, 'fs30', 47)" onmouseover="showTip(event, 'fs30', 47)" class="fn">value</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 48)" onmouseover="showTip(event, 'fs31', 48)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs30', 49)" onmouseover="showTip(event, 'fs30', 49)" class="fn">value</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 50)" onmouseover="showTip(event, 'fs32', 50)" class="id">ReflectionValue</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs33', 51)" onmouseover="showTip(event, 'fs33', 51)" class="uc">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 52)" onmouseover="showTip(event, 'fs31', 52)" class="fn">printfn</span> <span class="s">&quot;Got no result!&quot;</span>
</code></pre>
<p>This takes a string as an argument and evaluates (i.e. executes) it as F# code.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs26', 53)" onmouseover="showTip(event, 'fs26', 53)" class="fn">evalExpression</span> <span class="s">&quot;42+1&quot;</span> <span class="c">// prints &#39;43&#39;</span>
</code></pre>
<p>This can be used in a strongly typed way as follows:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Evaluate expression &amp; return the result, strongly typed</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 54)" onmouseover="showTip(event, 'fs34', 54)" class="fn">evalExpressionTyped</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs35', 55)" onmouseover="showTip(event, 'fs35', 55)" class="id">T</span><span class="pn">&gt;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 56)" onmouseover="showTip(event, 'fs27', 56)" class="fn">text</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs24', 57)" onmouseover="showTip(event, 'fs24', 57)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 58)" onmouseover="showTip(event, 'fs28', 58)" class="id">EvalExpression</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 59)" onmouseover="showTip(event, 'fs27', 59)" class="fn">text</span><span class="pn">)</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs29', 60)" onmouseover="showTip(event, 'fs29', 60)" class="uc">Some</span> <span onmouseout="hideTip(event, 'fs30', 61)" onmouseover="showTip(event, 'fs30', 61)" class="fn">value</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 62)" onmouseover="showTip(event, 'fs30', 62)" class="fn">value</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 63)" onmouseover="showTip(event, 'fs32', 63)" class="id">ReflectionValue</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs36', 64)" onmouseover="showTip(event, 'fs36', 64)" class="fn">unbox</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs35', 65)" onmouseover="showTip(event, 'fs35', 65)" class="id">T</span><span class="pn">&gt;</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs33', 66)" onmouseover="showTip(event, 'fs33', 66)" class="uc">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs37', 67)" onmouseover="showTip(event, 'fs37', 67)" class="fn">failwith</span> <span class="s">&quot;Got no result!&quot;</span>

<span onmouseout="hideTip(event, 'fs34', 68)" onmouseover="showTip(event, 'fs34', 68)" class="fn">evalExpressionTyped</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs38', 69)" onmouseover="showTip(event, 'fs38', 69)" class="vt">int</span><span class="pn">&gt;</span> <span class="s">&quot;42+1&quot;</span> <span class="c">// gives &#39;43&#39;</span>
</code></pre>
<p>The <code>EvalInteraction</code> method can be used to evaluate side-effectful operations
such as printing, declarations, or other interactions that are not valid F# expressions, but can be entered in
the F# Interactive console. Such commands include <code>#time "on"</code> (and other directives), <code>open System</code>
all declarations and other top-level statements. The code
does not require <code>;;</code> at the end. Just enter the code that you want to execute:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs24', 70)" onmouseover="showTip(event, 'fs24', 70)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 71)" onmouseover="showTip(event, 'fs39', 71)" class="id">EvalInteraction</span> <span class="s">&quot;printfn \&quot;bye\&quot;&quot;</span>
</code></pre>
<p>The <code>EvalScript</code> method allows to evaluate a complete .fsx script.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs40', 72)" onmouseover="showTip(event, 'fs40', 72)" class="rt">File</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 73)" onmouseover="showTip(event, 'fs41', 73)" class="id">WriteAllText</span><span class="pn">(</span><span class="s">&quot;sample.fsx&quot;</span><span class="pn">,</span> <span class="s">&quot;let twenty = 10 + 10&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs24', 74)" onmouseover="showTip(event, 'fs24', 74)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 75)" onmouseover="showTip(event, 'fs42', 75)" class="id">EvalScript</span> <span class="s">&quot;sample.fsx&quot;</span>
</code></pre>
<h2><a name="Catching-errors" class="anchor" href="#Catching-errors">Catching errors</a></h2>
<p><code>EvalExpression</code>, <code>EvalInteraction</code> and <code>EvalScript</code> are awkward if the
code has type checking warnings or errors, or if evaluation fails with an exception.
In these cases you can use <code>EvalExpressionNonThrowing</code>, <code>EvalInteractionNonThrowing</code>
and <code>EvalScriptNonThrowing</code>. These return a tuple of a result and an array of <code>FSharpDiagnostic</code> values.
These represent the errors and warnings. The result part is a <code>Choice&lt;_,_&gt;</code> between an actual
result and an exception.</p>
<p>The result part of <code>EvalExpression</code> and <code>EvalExpressionNonThrowing</code> is an optional <code>FSharpValue</code>.
If that value is not present then it just indicates that the expression didn't have a tangible
result that could be represented as a .NET object.  This situation shouldn't actually
occur for any normal input expressions, and only for primitives used in libraries.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs40', 76)" onmouseover="showTip(event, 'fs40', 76)" class="rt">File</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 77)" onmouseover="showTip(event, 'fs41', 77)" class="id">WriteAllText</span><span class="pn">(</span><span class="s">&quot;sample.fsx&quot;</span><span class="pn">,</span> <span class="s">&quot;let twenty = &#39;a&#39; + 10.0&quot;</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 78)" onmouseover="showTip(event, 'fs43', 78)" class="id">result</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs44', 79)" onmouseover="showTip(event, 'fs44', 79)" class="id">warnings</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs24', 80)" onmouseover="showTip(event, 'fs24', 80)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs45', 81)" onmouseover="showTip(event, 'fs45', 81)" class="id">EvalScriptNonThrowing</span> <span class="s">&quot;sample.fsx&quot;</span>

<span class="c">// show the result</span>
<span class="k">match</span> <span onmouseout="hideTip(event, 'fs43', 82)" onmouseover="showTip(event, 'fs43', 82)" class="id">result</span> <span class="k">with</span>
<span class="pn">|</span> <span onmouseout="hideTip(event, 'fs46', 83)" onmouseover="showTip(event, 'fs46', 83)" class="uc">Choice1Of2</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 84)" onmouseover="showTip(event, 'fs31', 84)" class="fn">printfn</span> <span class="s">&quot;checked and executed ok&quot;</span>
<span class="pn">|</span> <span onmouseout="hideTip(event, 'fs47', 85)" onmouseover="showTip(event, 'fs47', 85)" class="uc">Choice2Of2</span> <span onmouseout="hideTip(event, 'fs48', 86)" onmouseover="showTip(event, 'fs48', 86)" class="fn">exn</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 87)" onmouseover="showTip(event, 'fs31', 87)" class="fn">printfn</span> <span class="s">&quot;execution exception: </span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs48', 88)" onmouseover="showTip(event, 'fs48', 88)" class="fn">exn</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs49', 89)" onmouseover="showTip(event, 'fs49', 89)" class="id">Message</span>
</code></pre>
<p>Gives:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">execution</span> <span class="k">exception</span><span class="pn">:</span> <span class="id">Operation</span> <span class="id">could</span> <span class="id">not</span> <span class="id">be</span> <span class="id">completed</span> <span class="id">due</span> <span class="k">to</span> <span class="id">earlier</span> <span class="id">error</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// show the errors and warnings</span>
<span class="k">for</span> <span onmouseout="hideTip(event, 'fs50', 90)" onmouseover="showTip(event, 'fs50', 90)" class="fn">w</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs44', 91)" onmouseover="showTip(event, 'fs44', 91)" class="id">warnings</span> <span class="k">do</span>
    <span onmouseout="hideTip(event, 'fs31', 92)" onmouseover="showTip(event, 'fs31', 92)" class="fn">printfn</span> <span class="s">&quot;Warning </span><span class="pf">%s</span><span class="s"> at </span><span class="pf">%d</span><span class="s">,</span><span class="pf">%d</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs50', 93)" onmouseover="showTip(event, 'fs50', 93)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs51', 94)" onmouseover="showTip(event, 'fs51', 94)" class="id">Message</span> <span onmouseout="hideTip(event, 'fs50', 95)" onmouseover="showTip(event, 'fs50', 95)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs52', 96)" onmouseover="showTip(event, 'fs52', 96)" class="id">StartLine</span> <span onmouseout="hideTip(event, 'fs50', 97)" onmouseover="showTip(event, 'fs50', 97)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 98)" onmouseover="showTip(event, 'fs53', 98)" class="id">StartColumn</span>
</code></pre>
<p>Gives:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">Warning</span> <span class="id">The</span> <span class="k">type</span> <span class="id">&#39;</span><span class="id">float&#39;</span> <span class="id">does</span> <span class="id">not</span> <span class="k">match</span> <span class="id">the</span> <span class="k">type</span> <span class="id">&#39;</span><span class="id">char&#39;</span> <span class="id">at</span> <span class="n">1</span><span class="pn">,</span><span class="n">19</span>
<span class="id">Warning</span> <span class="id">The</span> <span class="k">type</span> <span class="id">&#39;</span><span class="id">float&#39;</span> <span class="id">does</span> <span class="id">not</span> <span class="k">match</span> <span class="id">the</span> <span class="k">type</span> <span class="id">&#39;</span><span class="id">char&#39;</span> <span class="id">at</span> <span class="n">1</span><span class="pn">,</span><span class="n">17</span>
</code></pre>
<p>For expressions:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 99)" onmouseover="showTip(event, 'fs54', 99)" class="fn">evalExpressionTyped2</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs35', 100)" onmouseover="showTip(event, 'fs35', 100)" class="id">T</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs27', 101)" onmouseover="showTip(event, 'fs27', 101)" class="fn">text</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 102)" onmouseover="showTip(event, 'fs55', 102)" class="fn">res</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs44', 103)" onmouseover="showTip(event, 'fs44', 103)" class="fn">warnings</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs24', 104)" onmouseover="showTip(event, 'fs24', 104)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs56', 105)" onmouseover="showTip(event, 'fs56', 105)" class="id">EvalExpressionNonThrowing</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 106)" onmouseover="showTip(event, 'fs27', 106)" class="fn">text</span><span class="pn">)</span>

    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs50', 107)" onmouseover="showTip(event, 'fs50', 107)" class="fn">w</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs44', 108)" onmouseover="showTip(event, 'fs44', 108)" class="fn">warnings</span> <span class="k">do</span>
        <span onmouseout="hideTip(event, 'fs31', 109)" onmouseover="showTip(event, 'fs31', 109)" class="fn">printfn</span> <span class="s">&quot;Warning </span><span class="pf">%s</span><span class="s"> at </span><span class="pf">%d</span><span class="s">,</span><span class="pf">%d</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs50', 110)" onmouseover="showTip(event, 'fs50', 110)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs51', 111)" onmouseover="showTip(event, 'fs51', 111)" class="id">Message</span> <span onmouseout="hideTip(event, 'fs50', 112)" onmouseover="showTip(event, 'fs50', 112)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs52', 113)" onmouseover="showTip(event, 'fs52', 113)" class="id">StartLine</span> <span onmouseout="hideTip(event, 'fs50', 114)" onmouseover="showTip(event, 'fs50', 114)" class="fn">w</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 115)" onmouseover="showTip(event, 'fs53', 115)" class="id">StartColumn</span>

    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs55', 116)" onmouseover="showTip(event, 'fs55', 116)" class="fn">res</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs46', 117)" onmouseover="showTip(event, 'fs46', 117)" class="uc">Choice1Of2</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs29', 118)" onmouseover="showTip(event, 'fs29', 118)" class="uc">Some</span> <span onmouseout="hideTip(event, 'fs30', 119)" onmouseover="showTip(event, 'fs30', 119)" class="fn">value</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 120)" onmouseover="showTip(event, 'fs30', 120)" class="fn">value</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 121)" onmouseover="showTip(event, 'fs32', 121)" class="id">ReflectionValue</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs36', 122)" onmouseover="showTip(event, 'fs36', 122)" class="fn">unbox</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs35', 123)" onmouseover="showTip(event, 'fs35', 123)" class="id">T</span><span class="pn">&gt;</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs46', 124)" onmouseover="showTip(event, 'fs46', 124)" class="uc">Choice1Of2</span> <span onmouseout="hideTip(event, 'fs33', 125)" onmouseover="showTip(event, 'fs33', 125)" class="uc">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs37', 126)" onmouseover="showTip(event, 'fs37', 126)" class="fn">failwith</span> <span class="s">&quot;null or no result&quot;</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs47', 127)" onmouseover="showTip(event, 'fs47', 127)" class="uc">Choice2Of2</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs48', 128)" onmouseover="showTip(event, 'fs48', 128)" class="fn">exn</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs48', 129)" onmouseover="showTip(event, 'fs48', 129)" class="rt">exn</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs37', 130)" onmouseover="showTip(event, 'fs37', 130)" class="fn">failwith</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs57', 131)" onmouseover="showTip(event, 'fs57', 131)" class="fn">sprintf</span> <span class="s">&quot;exception </span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs48', 132)" onmouseover="showTip(event, 'fs48', 132)" class="fn">exn</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs49', 133)" onmouseover="showTip(event, 'fs49', 133)" class="id">Message</span><span class="pn">)</span>

<span onmouseout="hideTip(event, 'fs54', 134)" onmouseover="showTip(event, 'fs54', 134)" class="fn">evalExpressionTyped2</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs38', 135)" onmouseover="showTip(event, 'fs38', 135)" class="vt">int</span><span class="pn">&gt;</span> <span class="s">&quot;42+1&quot;</span> <span class="c">// gives &#39;43&#39;</span>
</code></pre>
<h2><a name="Executing-in-parallel" class="anchor" href="#Executing-in-parallel">Executing in parallel</a></h2>
<p>By default the code passed to <code>EvalExpression</code> is executed immediately. To execute in parallel, submit a computation that starts a task:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 136)" onmouseover="showTip(event, 'fs6', 136)" class="id">System</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs58', 137)" onmouseover="showTip(event, 'fs58', 137)" class="id">Threading</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs59', 138)" onmouseover="showTip(event, 'fs59', 138)" class="id">Tasks</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs60', 139)" onmouseover="showTip(event, 'fs60', 139)" class="id">sampleLongRunningExpr</span> <span class="o">=</span>
    <span class="s">&quot;&quot;&quot;</span>
<span class="s">async {</span>
<span class="s">    // The code of what you want to run</span>
<span class="s">    do System.Threading.Thread.Sleep 5000</span>
<span class="s">    return 10</span>
<span class="s">}</span>
<span class="s">  |&gt; Async.StartAsTask&quot;&quot;&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 140)" onmouseover="showTip(event, 'fs61', 140)" class="d">task1</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs34', 141)" onmouseover="showTip(event, 'fs34', 141)" class="fn">evalExpressionTyped</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs62', 142)" onmouseover="showTip(event, 'fs62', 142)" class="d">Task</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs38', 143)" onmouseover="showTip(event, 'fs38', 143)" class="vt">int</span><span class="pn">&gt;</span><span class="pn">&gt;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs60', 144)" onmouseover="showTip(event, 'fs60', 144)" class="id">sampleLongRunningExpr</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs63', 145)" onmouseover="showTip(event, 'fs63', 145)" class="d">task2</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs34', 146)" onmouseover="showTip(event, 'fs34', 146)" class="fn">evalExpressionTyped</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs62', 147)" onmouseover="showTip(event, 'fs62', 147)" class="d">Task</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs38', 148)" onmouseover="showTip(event, 'fs38', 148)" class="vt">int</span><span class="pn">&gt;</span><span class="pn">&gt;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs60', 149)" onmouseover="showTip(event, 'fs60', 149)" class="id">sampleLongRunningExpr</span><span class="pn">)</span>
</code></pre>
<p>Both computations have now started.  You can now fetch the results:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs61', 150)" onmouseover="showTip(event, 'fs61', 150)" class="d">task1</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs64', 151)" onmouseover="showTip(event, 'fs64', 151)" class="id">Result</span> <span class="c">// gives the result after completion (up to 5 seconds)</span>
<span onmouseout="hideTip(event, 'fs63', 152)" onmouseover="showTip(event, 'fs63', 152)" class="d">task2</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs64', 153)" onmouseover="showTip(event, 'fs64', 153)" class="id">Result</span> <span class="c">// gives the result after completion (up to 5 seconds)</span>
</code></pre>
<h2><a name="Type-checking-in-the-evaluation-context" class="anchor" href="#Type-checking-in-the-evaluation-context">Type checking in the evaluation context</a></h2>
<p>Let's assume you have a situation where you would like to typecheck code
in the context of the F# Interactive scripting session. For example, you first
evaluate a declaration:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs24', 154)" onmouseover="showTip(event, 'fs24', 154)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 155)" onmouseover="showTip(event, 'fs39', 155)" class="id">EvalInteraction</span> <span class="s">&quot;let xxx = 1 + 1&quot;</span>
</code></pre>
<p>Now you want to typecheck the partially complete code <code>xxx + xx</code></p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 156)" onmouseover="showTip(event, 'fs65', 156)" class="id">parseResults</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs66', 157)" onmouseover="showTip(event, 'fs66', 157)" class="id">checkResults</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs67', 158)" onmouseover="showTip(event, 'fs67', 158)" class="id">checkProjectResults</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs24', 159)" onmouseover="showTip(event, 'fs24', 159)" class="d">fsiSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs68', 160)" onmouseover="showTip(event, 'fs68', 160)" class="id">ParseAndCheckInteraction</span><span class="pn">(</span><span class="s">&quot;xxx + xx&quot;</span><span class="pn">)</span>
</code></pre>
<p>The <code>parseResults</code> and <code>checkResults</code> have types <code>ParseFileResults</code> and <code>CheckFileResults</code>
explained in <a href="editor.html">Editor</a>. You can, for example, look at the type errors in the code:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs66', 161)" onmouseover="showTip(event, 'fs66', 161)" class="id">checkResults</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs69', 162)" onmouseover="showTip(event, 'fs69', 162)" class="prop">Diagnostics</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs70', 163)" onmouseover="showTip(event, 'fs70', 163)" class="id">Length</span> <span class="c">// 1</span>
</code></pre>
<p>The code is checked with respect to the logical type context available in the F# interactive session
based on the declarations executed so far.</p>
<p>You can also request declaration list information, tooltip text and symbol resolution:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// get a tooltip</span>
<span onmouseout="hideTip(event, 'fs66', 164)" onmouseover="showTip(event, 'fs66', 164)" class="id">checkResults</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs71', 165)" onmouseover="showTip(event, 'fs71', 165)" class="id">GetToolTip</span><span class="pn">(</span><span class="n">1</span><span class="pn">,</span> <span class="n">2</span><span class="pn">,</span> <span class="s">&quot;xxx + xx&quot;</span><span class="pn">,</span> <span class="pn">[</span> <span class="s">&quot;xxx&quot;</span> <span class="pn">]</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs72', 166)" onmouseover="showTip(event, 'fs72', 166)" class="m">FSharpTokenTag</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 167)" onmouseover="showTip(event, 'fs73', 167)" class="id">IDENT</span><span class="pn">)</span>

<span onmouseout="hideTip(event, 'fs66', 168)" onmouseover="showTip(event, 'fs66', 168)" class="id">checkResults</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs74', 169)" onmouseover="showTip(event, 'fs74', 169)" class="id">GetSymbolUseAtLocation</span><span class="pn">(</span><span class="n">1</span><span class="pn">,</span> <span class="n">2</span><span class="pn">,</span> <span class="s">&quot;xxx + xx&quot;</span><span class="pn">,</span> <span class="pn">[</span> <span class="s">&quot;xxx&quot;</span> <span class="pn">]</span><span class="pn">)</span> <span class="c">// symbol xxx</span>
</code></pre>
<h2><a name="The-fsi-object" class="anchor" href="#The-fsi-object">The 'fsi' object</a></h2>
<p>If you want your scripting code to be able to access the 'fsi' object, you should pass in an implementation of this object explicitly.
Normally the one from FSharp.Compiler.Interactive.Settings.dll is used.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs75', 170)" onmouseover="showTip(event, 'fs75', 170)" class="id">fsiConfig2</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs22', 171)" onmouseover="showTip(event, 'fs22', 171)" class="d">FsiEvaluationSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs23', 172)" onmouseover="showTip(event, 'fs23', 172)" class="id">GetDefaultConfiguration</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs24', 173)" onmouseover="showTip(event, 'fs24', 173)" class="d">fsiSession</span><span class="pn">)</span>
</code></pre>
<h2><a name="Collectible-code-generation" class="anchor" href="#Collectible-code-generation">Collectible code generation</a></h2>
<p>Evaluating code in using FsiEvaluationSession generates a .NET dynamic assembly and uses other resources.
You can make generated code collectible by passing <code>collectible=true</code>.  However, code will only
be collected if there are no outstanding object references involving types, for example
<code>FsiValue</code> objects returned by <code>EvalExpression</code>, and you must have disposed the <code>FsiEvaluationSession</code>.
See also <a href="https://learn.microsoft.com/previous-versions/dotnet/netframework-4.0/dd554932(v=vs.100)#restrictions">Restrictions on Collectible Assemblies</a>.</p>
<p>The example below shows the creation of 200 evaluation sessions. Note that <code>collectible=true</code> and
<code>use session = ...</code> are both used.</p>
<p>If collectible code is working correctly,
overall resource usage will not increase linearly as the evaluation progresses.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 174)" onmouseover="showTip(event, 'fs76', 174)" class="fn">collectionTest</span> <span class="pn">(</span><span class="pn">)</span> <span class="o">=</span>

    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs77', 175)" onmouseover="showTip(event, 'fs77', 175)" class="fn">i</span> <span class="k">in</span> <span class="n">1</span> <span class="o">..</span> <span class="n">200</span> <span class="k">do</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 176)" onmouseover="showTip(event, 'fs78', 176)" class="fn">defaultArgs</span> <span class="o">=</span>
            <span class="pn">[|</span> <span class="s">&quot;fsi.exe&quot;</span>
               <span class="s">&quot;--noninteractive&quot;</span>
               <span class="s">&quot;--nologo&quot;</span>
               <span class="s">&quot;--gui-&quot;</span> <span class="pn">|]</span>

        <span class="k">use</span> <span onmouseout="hideTip(event, 'fs12', 177)" onmouseover="showTip(event, 'fs12', 177)" class="d">inStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs13', 178)" onmouseover="showTip(event, 'fs13', 178)" class="d">StringReader</span><span class="pn">(</span><span class="s">&quot;&quot;</span><span class="pn">)</span>
        <span class="k">use</span> <span onmouseout="hideTip(event, 'fs14', 179)" onmouseover="showTip(event, 'fs14', 179)" class="d">outStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs15', 180)" onmouseover="showTip(event, 'fs15', 180)" class="d">StringWriter</span><span class="pn">(</span><span class="pn">)</span>
        <span class="k">use</span> <span onmouseout="hideTip(event, 'fs16', 181)" onmouseover="showTip(event, 'fs16', 181)" class="d">errStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs15', 182)" onmouseover="showTip(event, 'fs15', 182)" class="d">StringWriter</span><span class="pn">(</span><span class="pn">)</span>

        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 183)" onmouseover="showTip(event, 'fs21', 183)" class="fn">fsiConfig</span> <span class="o">=</span>
            <span onmouseout="hideTip(event, 'fs22', 184)" onmouseover="showTip(event, 'fs22', 184)" class="d">FsiEvaluationSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs23', 185)" onmouseover="showTip(event, 'fs23', 185)" class="id">GetDefaultConfiguration</span><span class="pn">(</span><span class="pn">)</span>

        <span class="k">use</span> <span onmouseout="hideTip(event, 'fs79', 186)" onmouseover="showTip(event, 'fs79', 186)" class="d">session</span> <span class="o">=</span>
            <span onmouseout="hideTip(event, 'fs22', 187)" onmouseover="showTip(event, 'fs22', 187)" class="d">FsiEvaluationSession</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 188)" onmouseover="showTip(event, 'fs25', 188)" class="id">Create</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 189)" onmouseover="showTip(event, 'fs21', 189)" class="fn">fsiConfig</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs78', 190)" onmouseover="showTip(event, 'fs78', 190)" class="fn">defaultArgs</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs12', 191)" onmouseover="showTip(event, 'fs12', 191)" class="d">inStream</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs14', 192)" onmouseover="showTip(event, 'fs14', 192)" class="d">outStream</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs16', 193)" onmouseover="showTip(event, 'fs16', 193)" class="d">errStream</span><span class="pn">,</span> <span class="fn">collectible</span> <span class="o">=</span> <span class="k">true</span><span class="pn">)</span>

        <span onmouseout="hideTip(event, 'fs79', 194)" onmouseover="showTip(event, 'fs79', 194)" class="d">session</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 195)" onmouseover="showTip(event, 'fs39', 195)" class="id">EvalInteraction</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs57', 196)" onmouseover="showTip(event, 'fs57', 196)" class="fn">sprintf</span> <span class="s">&quot;type D = { v : int }&quot;</span><span class="pn">)</span>

        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 197)" onmouseover="showTip(event, 'fs80', 197)" class="fn">v</span> <span class="o">=</span>
            <span onmouseout="hideTip(event, 'fs79', 198)" onmouseover="showTip(event, 'fs79', 198)" class="d">session</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 199)" onmouseover="showTip(event, 'fs28', 199)" class="id">EvalExpression</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs57', 200)" onmouseover="showTip(event, 'fs57', 200)" class="fn">sprintf</span> <span class="s">&quot;{ v = 42 * </span><span class="pf">%d</span><span class="s"> }&quot;</span> <span onmouseout="hideTip(event, 'fs77', 201)" onmouseover="showTip(event, 'fs77', 201)" class="fn">i</span><span class="pn">)</span>

        <span onmouseout="hideTip(event, 'fs31', 202)" onmouseover="showTip(event, 'fs31', 202)" class="fn">printfn</span> <span class="s">&quot;iteration </span><span class="pf">%d</span><span class="s">, result = </span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs77', 203)" onmouseover="showTip(event, 'fs77', 203)" class="fn">i</span> <span onmouseout="hideTip(event, 'fs80', 204)" onmouseover="showTip(event, 'fs80', 204)" class="fn">v</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs81', 205)" onmouseover="showTip(event, 'fs81', 205)" class="prop">Value</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 206)" onmouseover="showTip(event, 'fs32', 206)" class="id">ReflectionValue</span>

<span class="c">// collectionTest()  &lt;-- run the test like this</span>
</code></pre>

        <div class="fsdocs-tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="fsdocs-tip" id="fs2">namespace FSharp.Compiler</div>
<div class="fsdocs-tip" id="fs3">namespace FSharp.Compiler.Interactive</div>
<div class="fsdocs-tip" id="fs4">module Shell

from FSharp.Compiler.Interactive</div>
<div class="fsdocs-tip" id="fs5">namespace FSharp.Compiler.Tokenization</div>
<div class="fsdocs-tip" id="fs6">namespace System</div>
<div class="fsdocs-tip" id="fs7">namespace System.IO</div>
<div class="fsdocs-tip" id="fs8">namespace System.Text</div>
<div class="fsdocs-tip" id="fs9">val sbOut: StringBuilder</div>
<div class="fsdocs-tip" id="fs10">Multiple items<br />type StringBuilder =
  interface ISerializable
  new: unit -&gt; unit + 5 overloads
  member Append: value: bool -&gt; StringBuilder + 25 overloads
  member AppendFormat: provider: IFormatProvider * format: string * arg0: obj -&gt; StringBuilder + 14 overloads
  member AppendJoin: separator: char * [&lt;ParamArray&gt;] values: obj array -&gt; StringBuilder + 9 overloads
  member AppendLine: unit -&gt; StringBuilder + 3 overloads
  member Clear: unit -&gt; StringBuilder
  member CopyTo: sourceIndex: int * destination: char array * destinationIndex: int * count: int -&gt; unit + 1 overload
  member EnsureCapacity: capacity: int -&gt; int
  member Equals: span: ReadOnlySpan&lt;char&gt; -&gt; bool + 1 overload
  ...<br /><em>&lt;summary&gt;Represents a mutable string of characters. This class cannot be inherited.&lt;/summary&gt;</em><br /><br />--------------------<br />StringBuilder() : StringBuilder<br />StringBuilder(capacity: int) : StringBuilder<br />StringBuilder(value: string) : StringBuilder<br />StringBuilder(capacity: int, maxCapacity: int) : StringBuilder<br />StringBuilder(value: string, capacity: int) : StringBuilder<br />StringBuilder(value: string, startIndex: int, length: int, capacity: int) : StringBuilder</div>
<div class="fsdocs-tip" id="fs11">val sbErr: StringBuilder</div>
<div class="fsdocs-tip" id="fs12">val inStream: StringReader</div>
<div class="fsdocs-tip" id="fs13">Multiple items<br />type StringReader =
  inherit TextReader
  new: s: string -&gt; unit
  member Close: unit -&gt; unit
  member Peek: unit -&gt; int
  member Read: unit -&gt; int + 2 overloads
  member ReadAsync: buffer: char array * index: int * count: int -&gt; Task&lt;int&gt; + 1 overload
  member ReadBlock: buffer: Span&lt;char&gt; -&gt; int
  member ReadBlockAsync: buffer: char array * index: int * count: int -&gt; Task&lt;int&gt; + 1 overload
  member ReadLine: unit -&gt; string
  member ReadLineAsync: unit -&gt; Task&lt;string&gt; + 1 overload
  ...<br /><em>&lt;summary&gt;Implements a &lt;see cref=&quot;T:System.IO.TextReader&quot; /&gt; that reads from a string.&lt;/summary&gt;</em><br /><br />--------------------<br />StringReader(s: string) : StringReader</div>
<div class="fsdocs-tip" id="fs14">val outStream: StringWriter</div>
<div class="fsdocs-tip" id="fs15">Multiple items<br />type StringWriter =
  inherit TextWriter
  new: unit -&gt; unit + 3 overloads
  member Close: unit -&gt; unit
  member FlushAsync: unit -&gt; Task
  member GetStringBuilder: unit -&gt; StringBuilder
  member ToString: unit -&gt; string
  member Write: value: char -&gt; unit + 4 overloads
  member WriteAsync: value: char -&gt; Task + 4 overloads
  member WriteLine: buffer: ReadOnlySpan&lt;char&gt; -&gt; unit + 1 overload
  member WriteLineAsync: value: char -&gt; Task + 4 overloads
  ...<br /><em>&lt;summary&gt;Implements a &lt;see cref=&quot;T:System.IO.TextWriter&quot; /&gt; for writing information to a string. The information is stored in an underlying &lt;see cref=&quot;T:System.Text.StringBuilder&quot; /&gt;.&lt;/summary&gt;</em><br /><br />--------------------<br />StringWriter() : StringWriter<br />StringWriter(formatProvider: IFormatProvider) : StringWriter<br />StringWriter(sb: StringBuilder) : StringWriter<br />StringWriter(sb: StringBuilder, formatProvider: IFormatProvider) : StringWriter</div>
<div class="fsdocs-tip" id="fs16">val errStream: StringWriter</div>
<div class="fsdocs-tip" id="fs17">val argv: string array</div>
<div class="fsdocs-tip" id="fs18">val allArgs: string array</div>
<div class="fsdocs-tip" id="fs19">type Array =
  interface ICollection
  interface IEnumerable
  interface IList
  interface IStructuralComparable
  interface IStructuralEquatable
  interface ICloneable
  member Clone: unit -&gt; obj
  member CopyTo: array: Array * index: int -&gt; unit + 1 overload
  member GetEnumerator: unit -&gt; IEnumerator
  member GetLength: dimension: int -&gt; int
  ...<br /><em>&lt;summary&gt;Provides methods for creating, manipulating, searching, and sorting arrays, thereby serving as the base class for all arrays in the common language runtime.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs20">val append: array1: &#39;T array -&gt; array2: &#39;T array -&gt; &#39;T array</div>
<div class="fsdocs-tip" id="fs21">val fsiConfig: FsiEvaluationSessionHostConfig</div>
<div class="fsdocs-tip" id="fs22">type FsiEvaluationSession =
  interface IDisposable
  member AddBoundValue: name: string * value: obj -&gt; unit
  member EvalExpression: code: string -&gt; FsiValue option + 1 overload
  member EvalExpressionNonThrowing: code: string -&gt; Choice&lt;FsiValue option,exn&gt; * FSharpDiagnostic array + 1 overload
  member EvalInteraction: code: string * ?cancellationToken: CancellationToken -&gt; unit + 1 overload
  member EvalInteractionNonThrowing: code: string * ?cancellationToken: CancellationToken -&gt; Choice&lt;FsiValue option,exn&gt; * FSharpDiagnostic array + 1 overload
  member EvalScript: filePath: string -&gt; unit
  member EvalScriptNonThrowing: filePath: string -&gt; Choice&lt;unit,exn&gt; * FSharpDiagnostic array
  member FormatValue: reflectionValue: obj * reflectionType: Type -&gt; string
  member GetBoundValues: unit -&gt; FsiBoundValue list
  ...<br /><em>&lt;summary&gt;
 Represents an F# Interactive evaluation session.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs23">static member FsiEvaluationSession.GetDefaultConfiguration: unit -&gt; FsiEvaluationSessionHostConfig<br />static member FsiEvaluationSession.GetDefaultConfiguration: fsiObj: obj -&gt; FsiEvaluationSessionHostConfig<br />static member FsiEvaluationSession.GetDefaultConfiguration: fsiObj: obj * useFsiAuxLib: bool -&gt; FsiEvaluationSessionHostConfig</div>
<div class="fsdocs-tip" id="fs24">val fsiSession: FsiEvaluationSession</div>
<div class="fsdocs-tip" id="fs25">static member FsiEvaluationSession.Create: fsiConfig: FsiEvaluationSessionHostConfig * argv: string array * inReader: TextReader * outWriter: TextWriter * errorWriter: TextWriter * ?collectible: bool * ?legacyReferenceResolver: FSharp.Compiler.CodeAnalysis.LegacyReferenceResolver -&gt; FsiEvaluationSession</div>
<div class="fsdocs-tip" id="fs26">val evalExpression: text: string -&gt; unit<br /><em>&#160;Evaluate expression &amp; return the result</em></div>
<div class="fsdocs-tip" id="fs27">val text: string</div>
<div class="fsdocs-tip" id="fs28">member FsiEvaluationSession.EvalExpression: code: string -&gt; FsiValue option<br />member FsiEvaluationSession.EvalExpression: code: string * scriptFileName: string -&gt; FsiValue option</div>
<div class="fsdocs-tip" id="fs29">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs30">val value: FsiValue</div>
<div class="fsdocs-tip" id="fs31">val printfn: format: Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs32">property FsiValue.ReflectionValue: objnull with get<br /><em>&lt;summary&gt;
 The value, as an object
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs33">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs34">val evalExpressionTyped: text: string -&gt; &#39;T<br /><em>&#160;Evaluate expression &amp; return the result, strongly typed</em></div>
<div class="fsdocs-tip" id="fs35">&#39;T</div>
<div class="fsdocs-tip" id="fs36">val unbox: value: objnull -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs37">val failwith: message: string -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs38">Multiple items<br />val int: value: &#39;T -&gt; int (requires member op_Explicit)<br /><br />--------------------<br />type int = int32<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; =
  int</div>
<div class="fsdocs-tip" id="fs39">member FsiEvaluationSession.EvalInteraction: code: string * ?cancellationToken: Threading.CancellationToken -&gt; unit<br />member FsiEvaluationSession.EvalInteraction: code: string * scriptFileName: string * ?cancellationToken: Threading.CancellationToken -&gt; unit</div>
<div class="fsdocs-tip" id="fs40">type File =
  static member AppendAllBytes: path: string * bytes: byte array -&gt; unit + 1 overload
  static member AppendAllBytesAsync: path: string * bytes: byte array * ?cancellationToken: CancellationToken -&gt; Task + 1 overload
  static member AppendAllLines: path: string * contents: IEnumerable&lt;string&gt; -&gt; unit + 1 overload
  static member AppendAllLinesAsync: path: string * contents: IEnumerable&lt;string&gt; * encoding: Encoding * ?cancellationToken: CancellationToken -&gt; Task + 1 overload
  static member AppendAllText: path: string * contents: ReadOnlySpan&lt;char&gt; -&gt; unit + 3 overloads
  static member AppendAllTextAsync: path: string * contents: ReadOnlyMemory&lt;char&gt; * encoding: Encoding * ?cancellationToken: CancellationToken -&gt; Task + 3 overloads
  static member AppendText: path: string -&gt; StreamWriter
  static member Copy: sourceFileName: string * destFileName: string -&gt; unit + 1 overload
  static member Create: path: string -&gt; FileStream + 2 overloads
  static member CreateSymbolicLink: path: string * pathToTarget: string -&gt; FileSystemInfo
  ...<br /><em>&lt;summary&gt;Provides static methods for the creation, copying, deletion, moving, and opening of a single file, and aids in the creation of &lt;see cref=&quot;T:System.IO.FileStream&quot; /&gt; objects.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs41">File.WriteAllText(path: string, contents: string) : unit<br />File.WriteAllText(path: string, contents: ReadOnlySpan&lt;char&gt;) : unit<br />File.WriteAllText(path: string, contents: string, encoding: Encoding) : unit<br />File.WriteAllText(path: string, contents: ReadOnlySpan&lt;char&gt;, encoding: Encoding) : unit</div>
<div class="fsdocs-tip" id="fs42">member FsiEvaluationSession.EvalScript: filePath: string -&gt; unit</div>
<div class="fsdocs-tip" id="fs43">val result: Choice&lt;unit,exn&gt;</div>
<div class="fsdocs-tip" id="fs44">val warnings: FSharp.Compiler.Diagnostics.FSharpDiagnostic array</div>
<div class="fsdocs-tip" id="fs45">member FsiEvaluationSession.EvalScriptNonThrowing: filePath: string -&gt; Choice&lt;unit,exn&gt; * FSharp.Compiler.Diagnostics.FSharpDiagnostic array</div>
<div class="fsdocs-tip" id="fs46">union case Choice.Choice1Of2: &#39;T1 -&gt; Choice&lt;&#39;T1,&#39;T2&gt;</div>
<div class="fsdocs-tip" id="fs47">union case Choice.Choice2Of2: &#39;T2 -&gt; Choice&lt;&#39;T1,&#39;T2&gt;</div>
<div class="fsdocs-tip" id="fs48">Multiple items<br />val exn: exn<br /><br />--------------------<br />type exn = Exception</div>
<div class="fsdocs-tip" id="fs49">property Exception.Message: string with get</div>
<div class="fsdocs-tip" id="fs50">val w: FSharp.Compiler.Diagnostics.FSharpDiagnostic</div>
<div class="fsdocs-tip" id="fs51">property FSharp.Compiler.Diagnostics.FSharpDiagnostic.Message: string with get<br /><em>&lt;summary&gt;
 Gets the message for the diagnostic
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs52">property FSharp.Compiler.Diagnostics.FSharpDiagnostic.StartLine: int with get<br /><em>&lt;summary&gt;
 Gets the start line for the diagnostic
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs53">property FSharp.Compiler.Diagnostics.FSharpDiagnostic.StartColumn: int with get<br /><em>&lt;summary&gt;
 Gets the start column for the diagnostic
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs54">val evalExpressionTyped2: text: string -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs55">val res: Choice&lt;FsiValue option,exn&gt;</div>
<div class="fsdocs-tip" id="fs56">member FsiEvaluationSession.EvalExpressionNonThrowing: code: string -&gt; Choice&lt;FsiValue option,exn&gt; * FSharp.Compiler.Diagnostics.FSharpDiagnostic array<br />member FsiEvaluationSession.EvalExpressionNonThrowing: code: string * scriptFileName: string -&gt; Choice&lt;FsiValue option,exn&gt; * FSharp.Compiler.Diagnostics.FSharpDiagnostic array</div>
<div class="fsdocs-tip" id="fs57">val sprintf: format: Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs58">namespace System.Threading</div>
<div class="fsdocs-tip" id="fs59">namespace System.Threading.Tasks</div>
<div class="fsdocs-tip" id="fs60">val sampleLongRunningExpr: string</div>
<div class="fsdocs-tip" id="fs61">val task1: Task&lt;int&gt;</div>
<div class="fsdocs-tip" id="fs62">Multiple items<br />type Task =
  interface IAsyncResult
  interface IDisposable
  new: action: Action -&gt; unit + 7 overloads
  member ConfigureAwait: continueOnCapturedContext: bool -&gt; ConfiguredTaskAwaitable + 1 overload
  member ContinueWith: continuationAction: Action&lt;Task,obj&gt; * state: obj -&gt; Task + 19 overloads
  member Dispose: unit -&gt; unit
  member GetAwaiter: unit -&gt; TaskAwaiter
  member RunSynchronously: unit -&gt; unit + 1 overload
  member Start: unit -&gt; unit + 1 overload
  member Wait: unit -&gt; unit + 5 overloads
  ...<br /><em>&lt;summary&gt;Represents an asynchronous operation.&lt;/summary&gt;</em><br /><br />--------------------<br />type Task&lt;&#39;TResult&gt; =
  inherit Task
  new: ``function`` : Func&lt;obj,&#39;TResult&gt; * state: obj -&gt; unit + 7 overloads
  member ConfigureAwait: continueOnCapturedContext: bool -&gt; ConfiguredTaskAwaitable&lt;&#39;TResult&gt; + 1 overload
  member ContinueWith: continuationAction: Action&lt;Task&lt;&#39;TResult&gt;,obj&gt; * state: obj -&gt; Task + 19 overloads
  member GetAwaiter: unit -&gt; TaskAwaiter&lt;&#39;TResult&gt;
  member WaitAsync: cancellationToken: CancellationToken -&gt; Task&lt;&#39;TResult&gt; + 4 overloads
  member Result: &#39;TResult
  static member Factory: TaskFactory&lt;&#39;TResult&gt;<br /><em>&lt;summary&gt;Represents an asynchronous operation that can return a value.&lt;/summary&gt;<br />&lt;typeparam name=&quot;TResult&quot;&gt;The type of the result produced by this &lt;see cref=&quot;T:System.Threading.Tasks.Task`1&quot; /&gt;.&lt;/typeparam&gt;</em><br /><br />--------------------<br />Task(action: Action) : Task<br />Task(action: Action, cancellationToken: Threading.CancellationToken) : Task<br />Task(action: Action, creationOptions: TaskCreationOptions) : Task<br />Task(action: Action&lt;obj&gt;, state: obj) : Task<br />Task(action: Action, cancellationToken: Threading.CancellationToken, creationOptions: TaskCreationOptions) : Task<br />Task(action: Action&lt;obj&gt;, state: obj, cancellationToken: Threading.CancellationToken) : Task<br />Task(action: Action&lt;obj&gt;, state: obj, creationOptions: TaskCreationOptions) : Task<br />Task(action: Action&lt;obj&gt;, state: obj, cancellationToken: Threading.CancellationToken, creationOptions: TaskCreationOptions) : Task<br /><br />--------------------<br />Task(``function`` : Func&lt;&#39;TResult&gt;) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;obj,&#39;TResult&gt;, state: obj) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;&#39;TResult&gt;, cancellationToken: Threading.CancellationToken) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;&#39;TResult&gt;, creationOptions: TaskCreationOptions) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;obj,&#39;TResult&gt;, state: obj, cancellationToken: Threading.CancellationToken) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;obj,&#39;TResult&gt;, state: obj, creationOptions: TaskCreationOptions) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;&#39;TResult&gt;, cancellationToken: Threading.CancellationToken, creationOptions: TaskCreationOptions) : Task&lt;&#39;TResult&gt;<br />Task(``function`` : Func&lt;obj,&#39;TResult&gt;, state: obj, cancellationToken: Threading.CancellationToken, creationOptions: TaskCreationOptions) : Task&lt;&#39;TResult&gt;</div>
<div class="fsdocs-tip" id="fs63">val task2: Task&lt;int&gt;</div>
<div class="fsdocs-tip" id="fs64">property Task.Result: int with get<br /><em>&lt;summary&gt;Gets the result value of this &lt;see cref=&quot;T:System.Threading.Tasks.Task`1&quot; /&gt;.&lt;/summary&gt;<br />&lt;exception cref=&quot;T:System.AggregateException&quot;&gt;The task was canceled. The &lt;see cref=&quot;P:System.AggregateException.InnerExceptions&quot; /&gt; collection contains a &lt;see cref=&quot;T:System.Threading.Tasks.TaskCanceledException&quot; /&gt; object.  
  
 -or-  
  
 An exception was thrown during the execution of the task. The &lt;see cref=&quot;P:System.AggregateException.InnerExceptions&quot; /&gt; collection contains information about the exception or exceptions.&lt;/exception&gt;<br />&lt;returns&gt;The result value of this &lt;see cref=&quot;T:System.Threading.Tasks.Task`1&quot; /&gt;, which is of the same type as the task&#39;s type parameter.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs65">val parseResults: FSharp.Compiler.CodeAnalysis.FSharpParseFileResults</div>
<div class="fsdocs-tip" id="fs66">val checkResults: FSharp.Compiler.CodeAnalysis.FSharpCheckFileResults</div>
<div class="fsdocs-tip" id="fs67">val checkProjectResults: FSharp.Compiler.CodeAnalysis.FSharpCheckProjectResults</div>
<div class="fsdocs-tip" id="fs68">member FsiEvaluationSession.ParseAndCheckInteraction: code: string -&gt; FSharp.Compiler.CodeAnalysis.FSharpParseFileResults * FSharp.Compiler.CodeAnalysis.FSharpCheckFileResults * FSharp.Compiler.CodeAnalysis.FSharpCheckProjectResults</div>
<div class="fsdocs-tip" id="fs69">property FSharp.Compiler.CodeAnalysis.FSharpCheckFileResults.Diagnostics: FSharp.Compiler.Diagnostics.FSharpDiagnostic array with get<br /><em>&lt;summary&gt;
 The errors returned by parsing a source file.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs70">property Array.Length: int with get<br /><em>&lt;summary&gt;Gets the total number of elements in all the dimensions of the &lt;see cref=&quot;T:System.Array&quot; /&gt;.&lt;/summary&gt;<br />&lt;exception cref=&quot;T:System.OverflowException&quot;&gt;The array is multidimensional and contains more than &lt;see cref=&quot;F:System.Int32.MaxValue&quot;&gt;Int32.MaxValue&lt;/see&gt; elements.&lt;/exception&gt;<br />&lt;returns&gt;The total number of elements in all the dimensions of the &lt;see cref=&quot;T:System.Array&quot; /&gt;; zero if there are no elements in the array.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs71">member FSharp.Compiler.CodeAnalysis.FSharpCheckFileResults.GetToolTip: line: int * colAtEndOfNames: int * lineText: string * names: string list * tokenTag: int * ?width: int -&gt; FSharp.Compiler.EditorServices.ToolTipText</div>
<div class="fsdocs-tip" id="fs72">module FSharpTokenTag

from FSharp.Compiler.Tokenization<br /><em>&lt;summary&gt;
 Some of the values in the field FSharpTokenInfo.Tag
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs73">val IDENT: int<br /><em>&lt;summary&gt;
 Indicates the token is an identifier (synonym for FSharpTokenTag.Identifier)
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs74">member FSharp.Compiler.CodeAnalysis.FSharpCheckFileResults.GetSymbolUseAtLocation: line: int * colAtEndOfNames: int * lineText: string * names: string list -&gt; FSharp.Compiler.CodeAnalysis.FSharpSymbolUse option</div>
<div class="fsdocs-tip" id="fs75">val fsiConfig2: FsiEvaluationSessionHostConfig</div>
<div class="fsdocs-tip" id="fs76">val collectionTest: unit -&gt; unit</div>
<div class="fsdocs-tip" id="fs77">val i: int32</div>
<div class="fsdocs-tip" id="fs78">val defaultArgs: string array</div>
<div class="fsdocs-tip" id="fs79">val session: FsiEvaluationSession</div>
<div class="fsdocs-tip" id="fs80">val v: FsiValue option</div>
<div class="fsdocs-tip" id="fs81">property Option.Value: FsiValue with get</div>

    </div>
</main>
<aside id="fsdocs-page-menu">
    <p id="on-this-page">On this page</p>
    <ul>
  <li class="level-1">
    <a href="#Interactive-Service-Embedding-F-Interactive">
      Interactive Service: Embedding F# Interactive
    </a>
  </li>
  <li class="level-2">
    <a href="#Starting-the-F-interactive">
      Starting the F# interactive
    </a>
  </li>
  <li class="level-2">
    <a href="#Evaluating-and-executing-code">
      Evaluating and executing code
    </a>
  </li>
  <li class="level-2">
    <a href="#Catching-errors">
      Catching errors
    </a>
  </li>
  <li class="level-2">
    <a href="#Executing-in-parallel">
      Executing in parallel
    </a>
  </li>
  <li class="level-2">
    <a href="#Type-checking-in-the-evaluation-context">
      Type checking in the evaluation context
    </a>
  </li>
  <li class="level-2">
    <a href="#The-fsi-object">
      The 'fsi' object
    </a>
  </li>
  <li class="level-2">
    <a href="#Collectible-code-generation">
      Collectible code generation
    </a>
  </li>
</ul>
</aside>
<dialog>
    <input type="search" placeholder="Search docs" />
    <div class="results">
        <ul></ul>
        <p class="empty">Type something to start searching.</p>
    </div>
</dialog>
<script type="module" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-tips.js"></script>
<script type="module" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-theme-toggle.js"></script>
<script type="module" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-details-toggle.js"></script>
<script type="module" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-theme.js"></script>
<script type="module" src="https://fsharp.github.io/fsharp-compiler-docs/content/fsdocs-search.js"></script>

</body>
</html>